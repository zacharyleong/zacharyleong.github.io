---
import Layout from './Default.astro';
import BlogSideBar from '@components/projects/BlogSideBar.astro';
import BlogContent from '@components/projects/BlogContent.astro';
import RecentBlogPosts from '@components/generic/RecentBlogPosts.astro';

const ogImage = new URL(`/v1/generate/og/${Astro.params.slug}.png`, Astro.url);

// Accept both old format (content, headings) and new format (direct props)
const { content, headings } = Astro.props;
const title = content?.title || Astro.props.title;
const description = content?.description || Astro.props.description;

// Use provided headings or default to empty array
const tableOfContents = headings || [];

---

<Layout
  title={title as string}
  description={description as string}
  ogImage={ogImage}
>
  <main class='p-6 lg:grid lg:grid-cols-3 flex justify-center'>
    <BlogSideBar headings={tableOfContents} />
    <BlogContent content={content || Astro.props}>
      <slot />
    </BlogContent>
  </main>
  <section class='p-6'>
    <RecentBlogPosts count={6} filter={title}/>
  </section>
</Layout>
